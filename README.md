# 华中科技大学-2021-电子信息与通信-硬件课程设计
本仓库是2021届电子信息与通信学院的硬件课程设计，课题是触控键鼠设计，由2021届学生吴永浩、王梦婷、李鑫瑞合作完成。

本课程设计内容为一款基于触控感应技术的键盘与鼠标二合一设备。

## 系统组成模块包括：

### 1、 TTP226触控模块
TTP226是一种电容式触摸传感器IC，具有8个独立的触摸按键输入。其工作原理基于电容检测，通过感应电荷变化实现触摸检测。当用户触摸某个按键时，触摸点的电容值发生变化，TTP226检测到这一变化并将其转换为电信号。触控模块内部的处理电路对信号进行处理，去除干扰和噪声，然后通过引脚并行输出触摸信号。每个按键对应一个独立的输出引脚，确保各个按键的触摸信号能够被准确区分和传输。
工作步骤：
1.	电容感应：每个按键区域有一个电容，当用户触摸时，电容值发生变化。
2.	信号处理：TTP226内部的电路检测电容变化，并将其转换为电信号。
3.	输出信号：处理后的信号通过并行输出引脚传输，确保各个按键信号的准确性。

### 2、 HC-08蓝牙模块
HC-08是一款低功耗蓝牙模块，支持蓝牙4.0 BLE协议。系统中使用了两个HC-08模块，分别作为数据的发送和接收端。发送端HC-08模块通过串口与Nexys4DDR开发板连接，接收端HC-08模块通过串口-USB转换架连接到PC端口的USB传输线。数据传输过程中，TXD引脚负责发送数据，RXD引脚负责接收数据。HC-08模块在BLE协议下进行通信，具有低功耗、传输距离长和数据传输稳定的特点。
工作步骤：
1.	初始化：HC-08模块上电后初始化，设置波特率、角色（主/从）等参数。
2.	连接建立：发送端与接收端通过蓝牙协议进行配对和连接建立。
3.	数据传输：发送端通过TXD引脚发送数据，接收端通过RXD引脚接收数据。数据以串口数据帧格式进行传输，包括起始位、数据位、校验位和停止位。
4.	连接断开：数据传输完成后，蓝牙模块可以按照协议断开连接，进入低功耗模式。
硬件连接：
•	发送端：HC-08发送模块的TXD引脚连接到Nexys4DDR开发板的UART接收引脚（RX），RXD引脚连接到Nexys4DDR开发板的UART发送引脚（TX）。
•	接收端：HC-08接收模块的TXD引脚连接到串口-USB转换架的RX引脚，RXD引脚连接到串口-USB转换架的TX引脚。串口-USB转换架通过USB传输线连接到PC端口。

### 3、 Nexys4DDR开发板
Nexys4DDR开发板是一款基于Xilinx Artix-7 FPGA的开发板，提供丰富的外设接口和强大的逻辑资源。该开发板具有以下主要功能和特点：
•	FPGA资源：内置Xilinx Artix-7 FPGA，具有强大的逻辑处理能力，支持用户编写Verilog或VHDL代码实现复杂的硬件逻辑功能。
•	外设接口：板载提供多种外设接口，包括UART、SPI、I2C、GPIO等，可以与各种外部设备进行连接和通信。
•	存储资源：板载具有DDR2 SDRAM、Flash存储器等，支持数据的存储和访问。
•	开发环境：支持Xilinx的Vivado设计套件，通过编写硬件描述语言，实现FPGA内部逻辑功能。
在本项目中，Nexys4DDR开发板负责接收和处理来自TTP226触控模块的触摸信号。通过编写FPGA代码，实现对触摸信号的解析、处理和编码。处理后的数据通过UART接口传输到HC-08蓝牙发送模块，实现数据的无线传输。Nexys4DDR开发板在整个系统中充当核心处理单元，负责信号的实时处理和传输。

## 理论分析

  项目的核心在于电容触控检测和蓝牙通信的实现。电容触控检测依赖于TTP226模块，通过检测电容变化来感应触摸信号。电容触控技术的基本原理是，当用户的手指靠近或接触电容触摸传感器时，会改变传感器表面的电场分布，导致电容值的变化。TTP226模块内部集成了高灵敏度的电容检测电路，能够实时感应这些变化，并将其转换为电信号输出。触控信号通过并行引脚传输，确保各个按键的触摸信号能够被准确区分和传输。/n
  
  信号经TTP226处理后，通过信号采集电路传输至Nexys4DDR开发板。Nexys4DDR基于Xilinx Artix-7 FPGA，提供强大的逻辑处理能力和丰富的外设接口。FPGA通过编写Verilog或VHDL代码，实现对触控信号的进一步处理。处理过程包括信号去抖动、按键状态识别和信号编码等步骤。去抖动技术用于消除按键抖动造成的误触发，确保信号的准确性；按键状态识别则用于判断按键的按下和松开状态；信号编码则将处理后的触控信号转换为特定的格式，便于后续的传输和解析。
处理后的信号通过UART接口传输至HC-08蓝牙发送模块。HC-08是一款低功耗蓝牙模块，支持蓝牙4.0 BLE协议。蓝牙通信的实现需要遵循特定的协议规范，确保数据的稳定传输。HC-08模块通过串口与Nexys4DDR开发板连接，利用TXD和RXD引脚进行数据的发送和接收。数据传输过程中，TXD引脚负责将处理后的触控信号发送至蓝牙接收模块，而RXD引脚则用于接收来自蓝牙接收模块的反馈信号。

  蓝牙接收模块通过BLE协议接收到的数据通过串口-USB转换架传输至PC端口。BLE（Bluetooth Low Energy）协议是蓝牙4.0标准中的一个重要部分，具有低功耗、传输距离长和数据传输稳定的特点，适用于低功耗设备间的无线通信。串口-USB转换架将蓝牙接收模块的串口信号转换为USB信号，方便PC端口进行数据接收和处理。
  
  在PC端，使用C#编写的上位机程序负责接收和处理来自蓝牙接收模块的数据。程序通过串口通信接收数据，并对数据进行解析，将其转换为相应的键盘或鼠标指令。解析后的数据可以用于控制鼠标光标的移动、点击和键盘的按键操作。此外，PC端还可以运行使用Unity引擎编写的游戏程序，通过触控信号实现对游戏角色的控制，增强用户的互动体验。
  
  项目的实现涉及电容触控检测、信号处理、蓝牙通信和数据解析等多个环节。各个模块的协同工作，确保了系统的稳定性和实时性，实现了触控键盘的功能扩展和应用。通过合理的设计和实现，本项目在用户交互和应用扩展方面具有重要意义。
